<!DOCTYPE html>
<html>
<head>
    <title>读取微信文章</title>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
<script src="https://a.alipayobjects.com/u/js/201204/2S07Fhc1TN.js"></script> 
</head>
<body>
    <h2>公众号最近文章查询   <a href="index.php" target="_blank"> 公众号查询</a></h2>
<div class="selectAll">
    <ul>
        <li>请选择公众号：
            <select class="openid">
                <option value="oIWsFt7iH4VfITufiVW8QI_7FY04">大数据</option>
                <option value="oIWsFt4tMtQuLTETtblTNfj18J-s">大数据邦</option>
                <option value="oIWsFt-NQJJTI1l_HJBI-iEy3qbg">36氪</option>
                <option value="oIWsFt58NVJTkYWvPtICKgg8ka60">大数据文摘</option>
                <option value="oIWsFt8IGU5AmaISz9iiB4Vh1kYE">腾讯大数据</option>
                <option value="oIWsFt6hHZiswmg4LZ-1LitZX8E8">宽客大数据实验室</option>
            </select>
        </li>
        <li>我要查看第 <input type="text" value="1" class="page" /> 页
        </li>
        <li>
            以上必选 <input type="button" value="确认查询" id="submit" />
        </li>
    </ul>
    <h4 class="resultHead">您查询的公众号 <b class="gzh"></b>，共有文章 <b class="wz"></b> 篇，分为 <b class="ye"></b> 页。</h4><p>以下数据来源于搜狗浏览器查询结果，故以浏览器爬虫机器人(遵守 Robot.txt 协议)的更新时间为准。最新更新的文章在第一页</p>
</div>
<hr>
<ul class="list"></ul>
<script type="text/javascript">

var allId = {
    "大数据":"oIWsFt7iH4VfITufiVW8QI_7FY04",
    "大数据邦":"oIWsFt4tMtQuLTETtblTNfj18J-s",
    "36氪":"oIWsFt-NQJJTI1l_HJBI-iEy3qbg",
    "大数据文摘":"oIWsFt58NVJTkYWvPtICKgg8ka60",
    "腾讯大数据":"oIWsFt8IGU5AmaISz9iiB4Vh1kYE",
    "宽客大数据实验室":"oIWsFt6hHZiswmg4LZ-1LitZX8E8"
}

var allId = {"pubinfo":[
    {"name":""}
]}

var $openid = $('.openid');


function addOpenid (object){

/*    console.log(getObjectKeys(object));
    console.log(getObjectValues(object));*/

    //$openid.append('<option value="'+getObjectValues(object)+'">'+getObjectKeys(object)+'</option>');


        var keys = [];
        for (var property in object)
          keys.push(property);
        return keys;
        console.log(keys.length);



        var values = [];
        for (var property in object)
          values.push(object[property]);
        return values;

    console.log(allId.length);

    
}

addOpenid(allId);

function sogou(str){
    alert(str);
}
sogou.weixin =function(str){
    alert(str);
}
sogou.weixin.gzhcb = function(str){

    var domList = $('.list'),
        result = $('.resultHead'),
        htmlStr;

    function cHtml(i){
        domList.append("<li class='"+i+"'><p style='display:none'>xml源码：<textarea>"+decodeURI(htmlStr)+"</textarea></p><div class='doc"+i+"'></div></li>");
        //console.log(a.data('xml'));
        var textXml = $("."+i).find('textarea').text();
        var xmlToDoc = $("."+i).children('div');
        var arrayAll = textXml.split('title');
        //console.log(xmlToDoc.text());
        //console.log(arrayAll);

        var newTitle = arrayAll[1].split(']]></')[0].split('><![CDATA[')[1],
            newUrl = arrayAll[2].split(']]></url><')[0].split('><url><![CDATA[')[1],
            newdate = arrayAll[4].split('<date><![CDATA[')[1].split(']]></date>')[0];
            //console.log(newdate);
        xmlToDoc.append("<h3><a href='"+newUrl+"' target='_blank'> " + newTitle +" </a> <i> " + newdate+"</i></h3>");

        
    }

/*function decodeXml(i){
    var b = $("."+i);
    var arrayAll = decodeURI(b.data('xml')).split('title');
    b.html('<textarea>'+decodeURI(b.data('xml'))+'</textarea>');
    console.log(arrayAll[2]);

}*/

    domList.html('');
    //result.find('b').html('');

    var xmlDoc = (str.items),
        wenzhangAll = str.totalItems,
        pageAll = str.totalPages;
    //console.log(xmlDoc.length);
    $('.ye').html(pageAll);
    $('.wz').html(wenzhangAll);
    $('.gzh').html();

    //$(domList).append(encodeURI(xmlDoc));
    //console.log(xmlDoc);
    //console.log(typeof(xmlDoc));
    //alert(str.items);



    for (var i = 0; i < xmlDoc.length; i++) {
        var htmlStr = encodeURI(xmlDoc[i]);//encodeURI
        cHtml("xml_"+i);
        //decodeXml("xml_"+i);
        //setTimeout(cDocument("doc_"+i), 500);

    };


    
}

var otext = $("#submit");

otext.on('click',function(){

var page = $('.page').val(),
    t = '1415260390998',
    script,
    url='http://weixin.sogou.com/gzhjs?cb=sogou.weixin.gzhcb&openid='+$openid.val()+'&page='+page+'&t='+t;
    //url='http://w.sugg.sogou.com/sugg/ajaj_json.jsp?key='+ inputKey +'&type=wxpub&ori=yes&pr=web&abtestid=&ipn=';


    //if ($('.list').html()==''||$('.openid').val()!='oIWsFt5LBqZonLTOrdE6oMbmvzRU') {


        $('.resultHead').find('b').html('');
        
        
            
        if(script){
            document.body.removeChild(script);
        }else{
            script=document.createElement('script');
            script.src = url;
            document.body.appendChild(script);
        }




    //};


});
/*    $.ajax({ 
        url:'xml/weixin.xml', 
        type: 'GET', 
        dataType: 'xml', 
        timeout: 1000, 
        error: function(xml){ 
            alert('Error loading XML document'+xml); 
        }, 
        success: function(xml){ 
        	console.log('ok');

        }
    })*/




</script>
</body>
</html>